## 面向对象设计与构造预习作业2-1——冒险者游戏 

> 本单元主要目的是希望大家训练自己的思维方式，从面向过程向面向对象进行转变。并学习 Java 的基础语法知识，在 C 语言的基础上学习 Java 一些更加简单高效的方式。

----

### 第一部分：训练目标

**学会构建构造方法和对类进行封装，理解封装的作用**

java 类使用变量定义数据状态，使用方法定义行为。除此之外，类还提供了一种称为构造方法(constructor)的特殊方法，用于创建新对象。作为类的方法，构造方法虽然可以完成任何动作，但是构造方法的目标是为了完成初始化，因此构造方法的实现代码具有显著的特征，即对类中定义的成员变量进行初始化。按照变量的类型要区分两种情况：

- 原子类型的成员变量：一般是直接使用编程语言内置的数据类型所声明的变量，如 int ，boolean 等。这种成员变量一般可以直接赋值，如 `int price = 10`。

- 复合类型的成员变量：一般是使用编程语言类库或用户自定义的类(class)来声明的成员变量，如 `ArrayList myList` 。这种成员变量无法直接指定一个赋值结果，通常需要调用相应类型的构造方法来获得相应的初始值，如 `myList = new ArrayList()` 。

封装是面向对象方法的一个重要特征，强调对外隐藏对象的内部属性和实现细节，仅对外提供公共访问方式。这样做的优点是提高类的可复用性、安全性。

关键字 private 、protected 和 public 可以进一步对类的成员（包括变量和方法）的可见范围，被 private 修饰的成员只能在本类中使用；protected修饰的成员可以在本类及其直接子类使用；public修饰的成员可以在任意类中直接使用。一般而言，根据封装原则，如果没有特别的针对性考虑，建议对所有的成员变量使用private进行限定。

----

### 第二部分：预备知识

关于 Java：

>Java 是一门十分强大的语言，具有跨平台、安全等特点。Java语言得到广泛使用的一个重要原因是提供了丰富的类库，作为初学者你要养成多查阅和使用 Java 所提供的类的习惯，不要重复造轮子。在 pre 训练中，大家可以使用 Java 提供的相关容器，如 ArrayList、HashMap 等，会取得事半功倍的效果。

关于面向对象：

>面向对象是一种主流的软件开发方法，也是一种思维方式，其核心是识别类，并在类之间建立层次式的协作关系。面向对象思维需要逐步养成，是本课程的核心目标。作为 pre ，主要还是通过一些小的迭代式练习来初步感受面向对象方法。因为 pre 训练题目相对比较简单，通过传统上的结构化程序开发方法也可以实现代码，甚至可以只写一个函数就能完成任务，但希望大家不要这样做。千里之行，始于足下，希望大家从一开始就体会面向对象开发的特点，这也是 pre 训练的重要目标。

关于代码风格：

>顾名思义，代码风格是关于代码看起来的“风格 (style) ”，这是快速判断一个人的开发水平是否专业的重要切入点。目前，几乎所有的上规模软件企业都重视代码风格，并使用相关的工具进行自动检查。不少同学头一次接触**代码风格检查**，一开始可能会很难受：“我写个代码怎么还这么多事啊”！但是当你有了良好的代码风格后，你在写一个规模比较大的代码时就很能体会到代码风格的重要性。风格良好的代码你写起来对于整个脉络，命名都会掌握的比较清晰，可以省去很多不必要的重复审查；而且如果你一天没写完，第二天再打开，你能很快的上手，会让你有良好的体验。

在开始前，你需要先了解 java 的基础语法，包括表达式、for 循环、if 语句、输入输出、类，并学会编译运行 java 程序，Java 语言的很多成分都和 C 语言相似。

在任务迭代的开发过程中，会不可避免的涉及到变量名更改的问题，请尽量利用 IDEA 提供的重命名工具(Shift + F6)，不要自己手动一个个改。

----

### 第三部分：基本概念 

#### 一、从 C 到 Java

其实无论是 while、for 还是 if， switch，Java 与 C 基本上都是相同的，在你的简单预习中相信也发现了这个现象。在我们正式开始完成任务之前，再在 Java 与 C 关联的方面做一些简单介绍。

如下例子所示，在 Java 中 `public static void main(String[] argv)` 这条语句，就相当于C语言的入口函数`main()` 。这个 main 是你 Java 主程序的执行入口，当运行 Java 程序时，你可以理解成将会从此处开始执行。而在你的预习中相信也了解一些 Java 类相关的知识，在下面例子中我们看到程序入口出现在 MainClass 这个类中，我们一般把这个类称做“主类”。

```Java
import java.util.Scanner;

public class MainClass {
    public static void main(String[] argv) {
        Scanner scanner = new Scanner(System.in);
        int a = scanner.nextInt();
        double b = scanner.nextDouble();
        String c = scanner.next();
        System.out.println("Hello world!");
        System.out.println(c + b + a);
    }
}
```

现在我们可以运行一下这个程序，程序中已经包含了 Java 程序的输入输出方式，你也可以换一些组合方式，来进一步体会 Java 的输入输出。

#### 二、构造一个类

现在我们要正式开始本次任务了，在本次任务中我们希望构造一个 **Bottle** 类，来表示冒险者需要的物品，要求 **Bottle** 类包含以下属性：标识(`id`: 整数)，名字(`name`: 字符串)，价格(`price`: 整数)，容量(`capacity`: 浮点数)，和表达瓶子是否装满的标志量(`filled`: 布尔值)。
从某种意义上来说，只包含属性的类其实与 C 语言的结构体是很相似的。

以 Bottle 举例，构造一个类，代码如下：

```java
class Bottle {
    private int id;
    private String name;
    private long price;
    private double capacity;
    private boolean filled;
    
    public int getId(){
        return this.id;
    }
    public void setId(int id){
        this.id=id;
    }
}
```

我们会发现，所有属性均是私有的，外部完全看不到它们，这时，如果在主类中声明了一个 Bottle 的实例 bottle ，无法对 name 进行 `bottle.name` 的操作。如前所述，面向对象开发强调封装和私有保护，我们一般不允许把属性定义成 public 的。面向对象方法的基本特点是私有化保护内部数据，暴露对数据的必要操作接口，多数情况下可以提供 `setter-getter` 方法。但是需要注意，如果某个属性的取值不能允许外部进行无限制的修改，就不能提供公开的 setter 方法。

那么现在就是练习时间啦，请你把所有属性都私有化，将 Bottle 封装起来！并配置好相应的方法让他们能够被外部更改和访问。

> 小 tips：在之后的作业中，如果你对很多变量都需要重复实现 get 和 set 方法，挨个输入比较麻烦，有兴趣搜索一下 IDEA 的**一键生成方法（generate) 功能**，高效编码

#### 三、实例化！

我们现在拥有了一个 Bottle 类，那么问题来了，怎么在 MainClass 里引用他呢？我们可以把 Bottle 想像成一个像 `int`、`char` 一样的变量类型。那么我们就可以使用这条语句：`Bottle bottle;` 来声明一个`Bottle`变量了。在Java中，声明的对象**变量**就像是C语言中的一个结构体**指针**，如果你不对其初始化那么这个变量就会指向一个 `null` 量，代表这是一个空指针，此时还没有任何内存空间被分配用于存储一个Bottle的信息，你还需要使用**构造函数**实例化一个对象。
代码如下：

```java
public class MainClass {
    public static void main(String[] argv) {
        Bottle bottle = new Bottle();  //new Bottle() 即构造函数
        bottle.setName("Cola");
        bottle.setPrice(3);
        bottle.setId(1);
        bottle.setCapacity(100.0);
        bottle.setFilled(true);
    }
}
```

构造函数的用途是在你需要创建一个对象的时候完成一些初始化工作，并给对象的所有属性赋予初始值。

虽然 Java 语言默认为每个类提供一个缺省的构造方法，但是你并不确定这个缺省构造方法把每个属性设置成什么初值。对于上述的 Bottle 缺省构造方法而言，把 id 初始化为 0，把 price 初始化为 0，把 name 初始化为 null，把 capacity 初始化为0.0，把 filled 初始化为 false。我们建议显式方式来实现自己所需的合适的构造方法，确保得到的对象初始状态直观可见且可控。

在类中以"public 类名(参数列表)"的方式定义的函数就是构造函数。

这里举一个长方体类的例子：

```java
public class CuboidBox {
    private double length;
    private double width;
    private double height;

    // 构造函数
    public CuboidBox(double length, double width, double height) {
        this.length = length;
        this.width = width;
        this.height = height;
    }
}
```

那么现在就是练习时间啦，请你为 Bottle 写一个构造函数，要求该构造函数可以传入四个参数为 Bottle 赋值，同时需要初始化是否装满变量 `filled` 为 `true`。

----

### 第四部分：题目描述

先介绍 pre2 练习的背景故事。

想象你是一个冒险者，现在正在一个新的星球上进行探险，这个过程中你需要通过努力收集各种物品来不断增强自身能力值，在第一个 task 中你需要对第一个基本物品 Bottle 进行建模。

经过之前的预习和上面的练习现在到了实战的时候了：构造一个 **Bottle** 类，来表示冒险者需要用到的瓶子类，要求 **Bottle** 类包含属性：ID，名字，价格，容量，和表达瓶子是否装满的标志量。相应的要求完成的程序可以查询瓶子的 ID，名字，价格，容量以及是否装满。

一开始给出一个瓶子。之后，有 7 种操作:（序号即为操作数）

1. 查询名字
2. 查询价格
3. 查询容量
4. 查询是否装满
5. 更改价格
6. 设置是否装满
7. 输出瓶子描述字符串

----

### 第五部分：输入/输出格式

第一行给出 整数 `id` （取值范围为`0-2147483647`），字符串 `name` ，长整数 `price` 、浮点数 `capacity` 分别表示瓶子ID，名字，价格，容量，以空格分隔。<br>第二行一个数 $m$，表示待输入的操作数目。<br>

接下来 $m$​ 行，每行一个操作，输入的操作以`{type} {attribute}`的形式来描述，具体内容如下：

| type    | attribute  | 意义                                                         |
| ------- | ---------- | ------------------------------------------------------------ |
| 1/2/3/4 | 无         | 打印名字/价格/容量/是否装满（每个瓶子在创建之后**默认最开始是装满的**） |
| 5       | `{price}`  | 更改价格为 `{price}`                                         |
| 6       | `{filled}` | 更改瓶子装满的状态为 `{filled}`                              |
| 7       | 无         | 以`The bottle's id is {id}, name is {name}, capacity is {capacity}, filled is {filled}.`的形式打印状态。 |

**建议在 `Bottle` 类中定义 `toString` 方法，返回描述字符串，在主类的 `main` 方法中调用 `Bottle` 对象的 `toString` 方法来打印。**

#### 一、数据范围与操作限制

##### 变量约束

| 变量     | 类型   | 说明                     |
| -------- | ------ | ------------------------ |
| id       | 整数   | 取值范围：0 - 2147483647 |
| name     | 字符串 | 保证不会出现空白字符     |
| price    | 长整数 | 在 long 精度范围内       |
| capacity | 浮点数 | 在 double 精度范围内     |

##### 操作约束

* 操作数满足 $1 \leq m \leq 2000$​。

#### 二、测评方法

输出数值时，你的输出数值需要和正确数值相等。

**假设你的输出值 $x_{out}$ 和正确数值 $x_{std}$ 之间的绝对或相对误差小于等于  $10 ^ {-5}$，则认为是相等的，即满足**

$$
\dfrac {|x_{std} - x_{out}|}{\max(1, |x_{std}|)} \leq 10^{-5}
$$

#### 三、输入样例

```
12345667 water 20 100
8
1
2
3
4
5 30
6 true
7
2
```

#### 四、输出样例

```
water
20
100.0
true
The bottle's id is 12345667, name is water, capacity is 100.0, filled is true.
30
```

----

### 第六部分：提示

下面简单介绍 pre2 系列任务的迭代形式：

从 ***Task1*** 到 ***Task3*** ，逐步引导同学们实现一系列基础的类，并且熟悉类、属性和方法的使用，引导大家向面向对象的思维方式转变。

***Task4*** 涉及方法的重写和复用，并引入异常处理机制，希望同学们可以感性地体会到层次化设计的好处，了解并简单应用异常处理（异常处理在之后也常会用到）。

***Task5*** 涉及接口，需要同学们在之前 Task 的基础上完成更加复杂的操作。如果此时仍然使用原来的编码习惯，会在这个 Task 中遇到巨大困难，而严格按照我们的提示去做的同学会体会到好处。

强烈建议***按照从 Task1～Task5 的顺序完成 pre2 的练习***，思考如何进行增量迭代和持续重构，而不要在实现每一个 Task 时都完成一份新的代码。

